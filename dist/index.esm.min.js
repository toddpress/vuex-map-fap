import traverse from"traverse";function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _iterableToArrayLimit(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(n=(o=u.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==u.return||u.return()}finally{if(i)throw a}}return r}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function arrayToObject(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce(function(e,t){var r=t.split(".").slice(-1)[0];if(e[r])throw new Error("The key `".concat(r,"` is already in use."));return e[r]=t,e},{})}function computeTree(e,t,r,n,i){return t=JSON.parse(JSON.stringify(t)),traverse(t).forEach(function(t){var a="".concat(i,".").concat(this.path.join("."));this.isLeaf?Object.defineProperty(this.parent.node,this.key,buildLeafPropertyObject(e,a,n,r)):this.isRoot||Object.defineProperty(this.parent.node,this.key,buildBranchPropertyObject(e,t,a,n,r))})}function buildLeafPropertyObject(e,t,r,n){return{get:function(){return e.getters[r](t)},set:function(r){e.commit(n,{path:t,value:r})}}}function buildBranchPropertyObject(e,t,r,n,i){return{get:function(){return t},set:function(a){e.commit(i,{path:r,value:a}),t=computeTree(e,a,i,n,r)}}}function normalizeNamespace(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=_slicedToArray("string"==typeof r[0]?[].concat(r):[""].concat(r),4),a=i[0],o=i[1],u=i[2],c=i[3];return a.length&&"/"!==a.charAt(a.length-1)&&(a+="/"),u="".concat(a).concat(u||"getField"),c="".concat(a).concat(c||"updateField"),e(a,o,u,c)}}function getField(e){return function(t){return t.split(/[.[\]]+/).reduce(function(e,t){return e[t]},e)}}function updateField(e,t){var r=t.path,n=t.value;r.split(/[.[\]]+/).reduce(function(e,t,r,i){return i.length===r+1&&(e[t]=n),e[t]},e)}var mapFields=normalizeNamespace(function(e,t,r,n){var i=Array.isArray(t)?arrayToObject(t):t;return Object.keys(i).reduce(function(e,t){var a=i[t],o={get:function(){return this.$store.getters[r](a)},set:function(e){this.$store.commit(n,{path:a,value:e})}};return e[t]=o,e},{})}),mapMultiRowFields=normalizeNamespace(function(e,t,r,n){var i=Array.isArray(t)?arrayToObject(t):t;return Object.keys(i).reduce(function(e,t){var a,o=i[t];return e[t]={get:function(){var e=this.$store;if(a)return a;var t=e.getters[r](o);return a=computeTree(e,t,n,r,o)},set:function(e){var t=this.$store;if(t.commit(n,{path:o,value:e}),"object"!=typeof e)t.commit(n,{path:o,value:e});else{var i=t.getters[r](o);a=computeTree(t,i,n,r,o)}}},e},{})}),createHelpers=function(e){var t,r=e.getterType,n=e.mutationType;return _defineProperty(t={},r,getField),_defineProperty(t,n,updateField),_defineProperty(t,"mapFields",normalizeNamespace(function(e,t){return mapFields(e,t,r,n)})),_defineProperty(t,"mapMultiRowFields",normalizeNamespace(function(e,t){return mapMultiRowFields(e,t,r,n)})),t};export{createHelpers,getField,mapFields,mapMultiRowFields,updateField};